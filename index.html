<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Chat by Fan</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üì±</text></svg>">
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <!-- Firebase SDK -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js";
        import { getAuth, signInWithEmailAndPassword, createUserWithEmailAndPassword, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-auth.js";
        import { getDatabase, ref, set, onValue, push, update, remove, get, query, orderByChild, limitToLast } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-database.js";
        import { getStorage, ref as storageRef, uploadBytes, getDownloadURL } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-storage.js";

        // Firebase configuration - REPLACE WITH YOUR OWN CONFIG
        const firebaseConfig = {
            apiKey: "AIzaSyCU-2Oa0zjmzyAnBIrluPQbrf2t-lPiikg",
            authDomain: "chatbyfan.firebaseapp.com",
            databaseURL: "https://chatbyfan-default-rtdb.europe-west1.firebasedatabase.app",
            projectId: "chatbyfan",
            storageBucket: "chatbyfan.firebasestorage.app",
            messagingSenderId: "844332208537",
            appId: "1:844332208537:web:5b2747debe491ec8610308"
        };

        console.log('Firebase config loaded:', firebaseConfig.projectId);

        // Initialize Firebase
        console.log('Initializing Firebase app...');
        const app = initializeApp(firebaseConfig);
        console.log('Firebase app initialized');

        const auth = getAuth(app);
        console.log('Firebase Auth initialized');

        const database = getDatabase(app);
        console.log('Firebase Database initialized');

        const storage = getStorage(app);
        console.log('Firebase Storage initialized');

        // Make Firebase functions available globally
        window.auth = auth;
        window.database = database;
        window.storage = storage;
        window.signInWithEmailAndPassword = signInWithEmailAndPassword;
        window.createUserWithEmailAndPassword = createUserWithEmailAndPassword;
        window.signOut = signOut;
        window.onAuthStateChanged = onAuthStateChanged;
        window.dbRef = ref;
        window.set = set;
        window.onValue = onValue;
        window.push = push;
        window.update = update;
        window.remove = remove;
        window.get = get;
        window.query = query;
        window.orderByChild = orderByChild;
        window.limitToLast = limitToLast;
        window.storageRef = storageRef;
        window.uploadBytes = uploadBytes;
        window.getDownloadURL = getDownloadURL;
    </script>
</head>
<body>
    <!-- Auth Screen -->
    <div id="authScreen" class="auth-screen">
        <div class="auth-container">
            <div class="auth-header">
                <h1>Chat by Fan</h1>
                <p>–ë—ã—Å—Ç—Ä—ã–π –∏ –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä</p>
            </div>

            <!-- Login Form -->
            <div id="loginForm" class="auth-form">
                <h2>–í—Ö–æ–¥</h2>
                <input type="text" id="loginUsername" placeholder="–ù–∏–∫–Ω–µ–π–º" required>
                <input type="password" id="loginPassword" placeholder="–ü–∞—Ä–æ–ª—å" required>
                <button id="loginBtn" class="auth-btn">–í–æ–π—Ç–∏</button>
                <p class="auth-switch">–ù–µ—Ç –∞–∫–∫–∞—É–Ω—Ç–∞? <a href="#" id="showRegister">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</a></p>
            </div>

            <!-- Register Form -->
            <div id="registerForm" class="auth-form" style="display: none;">
                <h2>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h2>
                <input type="text" id="registerUsername" placeholder="–ù–∏–∫–Ω–µ–π–º" required>
                <input type="password" id="registerPassword" placeholder="–ü–∞—Ä–æ–ª—å" required>
                <button id="registerBtn" class="auth-btn">–°–æ–∑–¥–∞—Ç—å –∞–∫–∫–∞—É–Ω—Ç</button>
                <p class="auth-switch">–£–∂–µ –µ—Å—Ç—å –∞–∫–∫–∞—É–Ω—Ç? <a href="#" id="showLogin">–í–æ–π—Ç–∏</a></p>
            </div>
        </div>
    </div>

    <!-- Main App -->
    <div id="app" class="app" style="display: none;">
        <!-- Sidebar -->
        <div class="sidebar">
            <!-- User Profile -->
            <div class="user-profile">
                <div class="user-avatar">
                    <img id="userAvatar" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgdmlld0JveD0iMCAwIDEwMCAxMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxjaXJjbGUgY3g9IjUwIiBjeT0iNTAiIHI9IjUwIiBmaWxsPSIjNjY2NjY2Ii8+Cjx0ZXh0IHg9IjUwIiB5PSI2NSIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZmlsbD0id2hpdGUiIGZvbnQtc2l6ZT0iNDAiPkDwn5iKPC90ZXh0Pgo8L3N2Zz4=" alt="Avatar">
                </div>
                <div class="user-info">
                    <div class="user-name" id="userDisplayName">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</div>
                    <div class="user-status">–æ–Ω–ª–∞–π–Ω</div>
                </div>
            </div>

            <!-- Search -->
            <div class="search-container">
                <input type="text" id="searchInput" placeholder="–ü–æ–∏—Å–∫ —á–∞—Ç–æ–≤..." class="search-input">
            </div>

            <!-- Chats List -->
            <div class="chats-list" id="chatsList">
                <!-- Chats will be loaded here -->
            </div>

            <!-- New Chat Button -->
            <button class="new-chat-btn" id="newChatBtn">
                <span class="plus-icon">+</span>
                –ù–æ–≤—ã–π —á–∞—Ç
            </button>
        </div>

        <!-- Chat Area -->
        <div class="chat-area" id="chatArea">
            <!-- Empty State -->
            <div class="empty-state" id="emptyState">
                <div class="empty-icon">üí¨</div>
                <h2>–í—ã–±–µ—Ä–∏—Ç–µ —á–∞—Ç</h2>
                <p>–ù–∞—á–Ω–∏—Ç–µ –æ–±—â–µ–Ω–∏–µ —Å –¥—Ä—É–∑—å—è–º–∏</p>
            </div>

            <!-- Chat Header -->
            <div class="chat-header" id="chatHeader" style="display: none;">
                <div class="chat-avatar">
                    <img id="chatAvatar" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgdmlld0JveD0iMCAwIDEwMCAxMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxjaXJjbGUgY3g9IjUwIiBjeT0iNTAiIHI9IjUwIiBmaWxsPSIjNjY2NjY2Ii8+Cjx0ZXh0IHg9IjUwIiB5PSI2NSIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZmlsbD0id2hpdGUiIGZvbnQtc2l6ZT0iNDAiPkDwn5iKPC90ZXh0Pgo8L3N2Zz4=" alt="Chat Avatar">
                </div>
                <div class="chat-info">
                    <div class="chat-name" id="chatName">–ß–∞—Ç</div>
                    <div class="chat-status" id="chatStatus">–±—ã–ª(–∞) –Ω–µ–¥–∞–≤–Ω–æ</div>
                </div>
            </div>

            <!-- Messages Container -->
            <div class="messages-container" id="messagesContainer">
                <!-- Messages will be loaded here -->
            </div>

            <!-- Message Input -->
            <div class="message-input-container" id="messageInputContainer" style="display: none;">
                <div class="message-input-wrapper">
                    <input type="text" id="messageInput" placeholder="–ù–∞–ø–∏—à–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..." class="message-input">
                    <button class="send-btn" id="sendBtn"><img src="https://png.pngtree.com/png-vector/20250605/ourmid/pngtree-white-paper-airplane-in-flight-isolated-on-transparent-png-image_16468361.png" alt="Send" style="width: 20px; height: 20px;"></button>
                </div>
            </div>
        </div>
    </div>


    <!-- FAQ Button -->
    <button class="faq-btn" id="faqBtn">?</button>

    <!-- FAQ Modal -->
    <div class="modal" id="faqModal" style="display: none;">
        <div class="modal-content faq-modal-content">
            <div class="modal-header">
                <h3>FAQ</h3>
                <button class="close-modal" id="closeFaqModal">&times;</button>
            </div>
            <div class="modal-body">
                <p>–ù–∞—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ –ø—Ä–æ—à—É –Ω–µ –ø–∏—Å–∞—Ç—å –∏ –Ω–µ –æ—Å—Ç–∞–≤–ª—è—Ç—å –Ω–∏—á–µ–≥–æ –ª–∏—á–Ω–æ–≥–æ –∏ —Ç–æ–≥–æ, —á—Ç–æ –≤—ã –Ω–µ —Ö–æ—Ç–∏—Ç–µ —Å–∫—Ä—ã—Ç—å –æ—Ç –ø–æ—Å—Ç–æ—Ä–æ–Ω–Ω–∏—Ö –ª–∏—Ü. –°–∞–π—Ç –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –Ω–∞ —Å—Ç–∞–¥–∏–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏ –∏–º–µ–µ—Ç –æ—Ç–∫—Ä—ã—Ç—ã–π –∫–æ–¥!</p>
            </div>
        </div>
    </div>

    <!-- Modals -->
    <div class="modal" id="newChatModal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3>–ù–æ–≤—ã–π —á–∞—Ç</h3>
                <button class="close-modal" id="closeNewChatModal">&times;</button>
            </div>
            <div class="modal-body">
                <input type="text" id="newChatUsername" placeholder="–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è" class="modal-input">
                <button id="startNewChatBtn" class="modal-btn">–ù–∞—á–∞—Ç—å —á–∞—Ç</button>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
    <script src="auth.js"></script>
    <script src="chat.js"></script>
    <script src="ui.js"></script>
</body>
</html>